var P=Object.defineProperty;var I=r=>{throw TypeError(r)};var M=(r,t,e)=>t in r?P(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var L=(r,t,e)=>M(r,typeof t!="symbol"?t+"":t,e),O=(r,t,e)=>t.has(r)||I("Cannot "+e);var o=(r,t,e)=>(O(r,t,"read from private field"),e?e.call(r):t.get(r)),c=(r,t,e)=>t.has(r)?I("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),l=(r,t,e,i)=>(O(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const w of n.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&i(w)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var u,h;class D{constructor(t=5){c(this,u);c(this,h);l(this,u,t),l(this,h,this.makeGrid())}makeGrid(){const t=[];for(let e=0;e<o(this,u);e++){const i=[];for(let s=0;s<o(this,u);s++)i.push(0);t.push(i)}return t}isEmptyCell(t,e){return o(this,h)[t][e]===0}setCell(t,e,i){o(this,h)[t][e]=i}getGrid(){return o(this,h)}getSize(){return o(this,u)}resetBoard(){l(this,h,this.makeGrid())}}u=new WeakMap,h=new WeakMap;var g,a;const b=class b{constructor(){c(this,g);c(this,a);const t=document.getElementById(b.APP_ID);if(!t)throw new Error("app element not found");l(this,g,t),this.createResetButton()}render(t,e=0,i=[]){o(this,g).innerHTML="";const s=t.getGrid(),n=document.createElement("div");n.classList.add("board"),s.forEach((w,B)=>{const y=document.createElement("div");y.classList.add("row"),w.forEach((E,v)=>{const d=document.createElement("div");d.dataset.rowIdx=B.toString(),d.dataset.colIdx=v.toString(),d.classList.add("cell"),E!==0&&(d.innerText=E.toString(),d.classList.add("selected")),e&&e===E&&d.classList.add("active"),i.some(C=>C.row===B&&C.col===v)&&d.classList.add("possible_move"),y.appendChild(d)}),n.appendChild(y)}),o(this,g).appendChild(n)}createResetButton(){const t=document.getElementById(b.TOOLBAR_ID);t&&(o(this,a)||(l(this,a,document.createElement("button")),o(this,a).textContent="Сбросить",t.appendChild(o(this,a))))}resetBtn(t){o(this,a)&&(o(this,a).onclick=t)}};g=new WeakMap,a=new WeakMap,L(b,"APP_ID","app"),L(b,"TOOLBAR_ID","toolbar");let _=b;var f,m,p;class G{constructor(t,e){c(this,f,0);c(this,m,null);c(this,p,null);this._board=t,this._html=e,this.listenBoard(),this._html.resetBtn(()=>this.startNewGame()),this._html.render(this._board)}listenBoard(){var t;(t=document.getElementById(_.APP_ID))==null||t.addEventListener("click",e=>{const i=e.target;if(!i.classList.contains("cell"))return;const s=i.dataset.rowIdx?Number(i.dataset.rowIdx):null,n=i.dataset.colIdx?Number(i.dataset.colIdx):null;s===null||n===null||this._board.isEmptyCell(s,n)&&this.isValidMove(s,n)&&this.moveHorse(s,n)})}moveHorse(t,e){l(this,f,o(this,f)+1),l(this,m,t),l(this,p,e),this._board.setCell(t,e,o(this,f));const i=this.getValidMoves(t,e);this._html.render(this._board,o(this,f),i)}isValidMove(t,e){if(o(this,m)!==null&&o(this,p)!==null){const i=Math.abs(t-o(this,m)),s=Math.abs(e-o(this,p));return i===2&&s===1||i===1&&s===2}return!0}getValidMoves(t,e){return[{row:t-2,col:e-1},{row:t-2,col:e+1},{row:t+2,col:e-1},{row:t+2,col:e+1},{row:t-1,col:e-2},{row:t-1,col:e+2},{row:t+1,col:e-2},{row:t+1,col:e+2}].filter(s=>s.row>=0&&s.row<this._board.getSize()&&s.col>=0&&s.col<this._board.getSize()&&this._board.isEmptyCell(s.row,s.col))}startNewGame(){l(this,f,0),l(this,p,null),l(this,m,null),this._board.resetBoard(),this._html.render(this._board)}}f=new WeakMap,m=new WeakMap,p=new WeakMap;const N=new D,S=new _;new G(N,S);
